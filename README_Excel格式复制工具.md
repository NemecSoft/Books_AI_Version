# Excel格式复制工具使用说明

## 工具简介

本工具是一个用于批量将JSON文件数据导出到Excel并保留模板格式的GUI工具。它能够从指定的Excel模板中复制第一行的样式，并应用到所有数据行，确保生成的Excel文件具有一致的格式。

## 功能特点

- 支持选择Excel模板文件，自动从第一行复制样式到所有数据行
- 可批量添加多个JSON文件或整个文件夹中的JSON文件
- 支持预览已添加的JSON文件列表
- 自动处理JSON数据结构，提取标题、极简版、简化版和详细版字段
- 确保文本自动换行，改善阅读体验
- 保留模板文件中的列宽和行高设置

## 系统要求

- Python 3.7+
- 所需Python库：
  - pandas
  - openpyxl
  - tkinter (通常随Python一起安装)

## 安装依赖

```bash
pip install pandas openpyxl
```

## 使用步骤

1. **运行工具**
   ```bash
   python excel_format_copier.py
   ```

2. **选择模板文件**
   - 点击"选择模板"按钮
   - 从文件选择对话框中选择一个Excel模板文件（.xlsx格式）
   - 确保模板文件的第一行包含所需的格式设置

3. **添加JSON文件**
   - 点击"添加JSON文件"按钮可以选择单个或多个JSON文件
   - 点击"添加文件夹中的JSON"按钮可以自动添加整个文件夹中的所有JSON文件
   - 工具会自动验证JSON文件格式是否符合要求

4. **管理文件列表**
   - 可以在表格中查看已添加的文件
   - 选择文件后点击"移除选中"可以删除不需要的文件
   - 点击"清空列表"可以删除所有文件

5. **生成Excel文件**
   - 点击"开始生成Excel"按钮
   - 选择保存路径和文件名
   - 工具会自动处理数据并应用模板格式

## JSON文件格式要求

JSON文件必须包含以下结构：

```json
{
  "基础信息": {
    "标题": "章回标题"
  },
  "极简版": ["事件1", "事件2", ...],
  "简化版": ["事件1", "事件2", ...],
  "详细版": ["事件1", "事件2", ...]
}
```

## 注意事项

1. 确保Excel模板文件(.xlsx)格式正确，特别是第一行的格式设置
2. JSON文件必须符合规定的结构，否则可能导致导入失败
3. 对于大型Excel文件，生成过程可能需要一些时间
4. 工具会自动将事件列表转换为带有编号的多行文本
5. 所有单元格都会应用文本自动换行设置，确保长文本能够正常显示

## 常见问题解答

1. **问：为什么选择模板后没有显示完整的文件路径？**
   **答：** 工具默认只显示文件名，以保持界面整洁。完整路径可以在文件列表中查看。

2. **问：JSON文件导入失败怎么办？**
   **答：** 请检查JSON文件格式是否符合要求，确保包含所有必要的字段。

3. **问：生成的Excel文件中格式不正确怎么办？**
   **答：** 请确保模板文件的第一行包含正确的格式设置，工具会从第一行复制格式。

4. **问：如何调整生成文件中的列宽？**
   **答：** 请在模板文件中调整列宽，工具会保留这些设置。

## 优化建议

1. **性能优化：** 对于大量数据，可以考虑分批处理以提高性能
2. **错误处理：** 工具包含基本的错误处理，但在处理异常复杂的数据时可能需要进一步优化
3. **界面改进：** 可以根据需要调整界面布局和样式

## 版本信息

- 版本：1.0
- 发布日期：2025年
- 开发者：AI编程助手
